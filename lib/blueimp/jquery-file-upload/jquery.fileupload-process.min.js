(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery","./jquery.fileupload"],e)}else if(typeof exports==="object"){e(require("jquery"),require("./jquery.fileupload"))}else{e(window.jQuery)}})((function(e){"use strict";var r=e.blueimp.fileupload.prototype.options.add;e.widget("blueimp.fileupload",e.blueimp.fileupload,{options:{processQueue:[],add:function(s,i){var o=e(this);i.process((function(){return o.fileupload("process",i)}));r.call(this,s,i)}},processActions:{},_processFile:function(r,s){var i=this,o=e.Deferred().resolveWith(i,[r]),t=o.promise();this._trigger("process",null,r);e.each(r.processQueue,(function(r,o){var n=function(r){if(s.errorThrown){return e.Deferred().rejectWith(i,[s]).promise()}return i.processActions[o.action].call(i,r,o)};t=t[i._promisePipe](n,o.always&&n)}));t.done((function(){i._trigger("processdone",null,r);i._trigger("processalways",null,r)})).fail((function(){i._trigger("processfail",null,r);i._trigger("processalways",null,r)}));return t},_transformProcessQueue:function(r){var s=[];e.each(r.processQueue,(function(){var i={},o=this.action,t=this.prefix===true?o:this.prefix;e.each(this,(function(s,o){if(e.type(o)==="string"&&o.charAt(0)==="@"){i[s]=r[o.slice(1)||(t?t+s.charAt(0).toUpperCase()+s.slice(1):s)]}else{i[s]=o}}));s.push(i)}));r.processQueue=s},processing:function(){return this._processing},process:function(r){var s=this,i=e.extend({},this.options,r);if(i.processQueue&&i.processQueue.length){this._transformProcessQueue(i);if(this._processing===0){this._trigger("processstart")}e.each(r.files,(function(o){var t=o?e.extend({},i):i,n=function(){if(r.errorThrown){return e.Deferred().rejectWith(s,[r]).promise()}return s._processFile(t,r)};t.index=o;s._processing+=1;s._processingQueue=s._processingQueue[s._promisePipe](n,n).always((function(){s._processing-=1;if(s._processing===0){s._trigger("processstop")}}))}))}return this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=e.Deferred().resolveWith(this).promise()}})}));