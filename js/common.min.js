/**
 * ---------------------------------------------------------------------
 *
 * GLPI - Gestionnaire Libre de Parc Informatique
 *
 * http://glpi-project.org
 *
 * @copyright 2015-2022 Teclib' and contributors.
 * @copyright 2003-2014 by the INDEPNET Development Team.
 * @licence   https://www.gnu.org/licenses/gpl-3.0.html
 *
 * ---------------------------------------------------------------------
 *
 * LICENSE
 *
 * This file is part of GLPI.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 *
 * ---------------------------------------------------------------------
 */
var timeoutglobalvar;function setdisplay(e,t){var a=e;if(a.style.display!=t){a.style.display=t}return true}function cleandisplay(e){var t=document.getElementById(e);if(t){setdisplay(t,"block")}}function cleanhide(e){var t=document.getElementById(e);if(t){setdisplay(t,"none")}}function fillidfield(e,t){window.opener.document.forms.helpdeskform.elements.items_id.value=t;window.opener.document.forms.helpdeskform.elements.itemtype.value=e;window.close()}function markCheckboxes(e){var t=document.getElementById(e).getElementsByTagName("input");for(var a=0;a<t.length;a++){var n=t[a];if(n&&n.type=="checkbox"){if(n.disabled===false){n.checked=true}}}return true}function unMarkCheckboxes(e){var t=document.getElementById(e).getElementsByTagName("input");for(var a=0;a<t.length;a++){var n=t[a];if(n&&n.type=="checkbox"){n.checked=false}}return true}function displayOtherSelectOptions(e,t){if(e.options[e.selectedIndex].value==t){document.getElementById(t).style.display="inline"}else{document.getElementById(t).style.display="none"}return true}function checkAsCheckboxes(e,t){e=typeof e==="string"?document.getElementById(e):e;$("#"+t+' input[type="checkbox"]:enabled').prop("checked",$(e).is(":checked"));return true}$.fn.shiftSelectable=function(){var e;var t=this;document.onkeydown=function(e){var t=e.keyCode;if(t==16){$("html").addClass("user-select-none");document.onkeyup=function(){$("html").removeClass("user-select-none")}}};$(t).parent().click((function(a){var n=$(this).children("input[type=checkbox]");if(!e){e=n;return}if(a.shiftKey){var r=t.index(n);var i=t.index(e);t.slice(Math.min(r,i),Math.max(r,i)).prop("checked",$(e).is(":checked")).trigger("change")}e=n}))};function showHideDiv(e,t,a,n){var r=$("#"+e);if(t!==""){var i=a.match(/^fa-/);var o;var s;if(!i){s=$("img[name="+t+"]");if(r.is(":visible")){s.attr("src",a)}else{s.attr("src",n)}}else{o=$("#"+t);if(r.is(":visible")){o.removeClass(n).addClass(a)}else{o.removeClass(a).addClass(n)}}}if(r.is(":visible")){r.hide()}else{r.show()}}function toogle(e,t,a,n){if(document.getElementById){if(document.getElementById(e).value=="0"){document.getElementById(e).value="1";if(t!==""){document[t].src=a}}else{document.getElementById(e).value="0";if(t!==""){document[t].src=n}}}}function toggleTableDisplay(e,t,a,n){var r=document.getElementById(e).rows;for(var i=0;i<r.length;i++){if(r[i].className.indexOf("headerRow")==-1){if(r[i].style.display=="none"){r[i].style.display="table-row";if(t!==""){document[t].src=n}}else{r[i].style.display="none";if(t!==""){document[t].src=a}}}}if(document.getElementById(e+"2")){toggleTableDisplay(e+"2","")}if(document.getElementById(e+"3")){toggleTableDisplay(e+"3","")}if(document.getElementById(e+"4")){toggleTableDisplay(e+"4","")}if(document.getElementById(e+"5")){toggleTableDisplay(e+"5","")}}function submitGetLink(e,t){var a=document.createElement("form");a.method="post";a.action=e;for(var n in t){var r=document.createElement("input");r.setAttribute("name",n);r.setAttribute("value",t[n]);a.appendChild(r)}document.body.appendChild(a);a.submit();document.body.removeChild(a)}function selectAll(e){var t=$("#"+e);var a=[];t.find("option").each((function(e,t){a[a.length]=$(t).attr("value")}));t.val(a);t.trigger("change")}function deselectAll(e){$("#"+e).val("").trigger("change")}function massiveUpdateCheckbox(e,t){var a=null;if(typeof t=="boolean"){a=t}else if(typeof t=="string"){a=$("#"+t).prop("checked")}else if(typeof t=="object"){a=$(t).prop("checked")}if(typeof a=="undefined"){return false}$(e).each((function(){if(typeof t=="undefined"){a=!$(this).prop("checked")}$(this).prop("checked",a)}));return true}var filter_timeline=function(){$(document).on("click",".filter_timeline li a",(function(e){e.preventDefault();var t=$(this);$(".h_item").addClass("h_hidden");if(t.data("type")=="reset"){$(".filter_timeline li a").removeClass("h_active");$(".h_item").removeClass("h_hidden");return}t.toggleClass("h_active");var a=[];$(".filter_timeline .h_active").each((function(){a.push(".h_content."+$(this).data("type"))}));$(a.join(", ")).each((function(){$(this).parent().removeClass("h_hidden")}));if(a.length===0){$(".h_item").removeClass("h_hidden")}}))};var read_more=function(){$(document).on("click",".long_text .read_more a, .long_text .read_more .read_more_button",(function(){$(this).parents(".long_text").removeClass("long_text");$(this).parent(".read_more").remove();return false}))};if($(window).width()<=700){var didScroll;var lastScrollTop=0;var delta=5;var navbarHeight=$("header").outerHeight();$(window).scroll((function(){didScroll=true}));setInterval((function(){if(didScroll){scollHeaderResponsive();didScroll=false}}),250);var scollHeaderResponsive=function(){var e=$(this).scrollTop();if(Math.abs(lastScrollTop-e)<=delta){return}if(e>lastScrollTop&&e>navbarHeight){$("#header").removeClass("nav-down").addClass("nav-up")}else{if(e+$(window).height()<$(document).height()){$("#header").removeClass("nav-up").addClass("nav-down")}}lastScrollTop=e}}var switchFoldMenu=function(){$.ajax({url:CFG_GLPI.root_doc+"/ajax/switchfoldmenu.php",type:"POST",datatype:"json",success:function(e){if(e.success===true){$("body").toggleClass("navbar-collapsed");var t=$("body").hasClass("navbar-collapsed");$("#navbar-menu li.dropdown").toggleClass("dropend");$("#navbar-menu .dropdown-menu.animate__animated").toggleClass("animate__animated");if(t){$("#navbar-menu .dropdown-menu, #navbar-menu .nav-link").removeClass("show")}else{if($("#navbar-menu .nav-link.show").length==0){$("#navbar-menu .nav-link.active + .dropdown-menu").addClass("show")}}}}})};$((function(){if($("html").hasClass("loginpage")){return}$("body").delegate("td","mouseover mouseleave",(function(e){var t=$(this).closest("tr").children().index($(this));var a=$(this).closest("tr");if(!$(this).closest("tr").hasClass("noHover")){if(e.type=="mouseover"){a.addClass("rowHover");if(a.has("td[rowspan]").length===0){a.prevAll("tr:has(td[rowspan]):first").find("td[rowspan]").addClass("rowHover")}$(this).closest("table").find("tr:not(.noHover) th:nth-child("+(t+1)+")").addClass("headHover")}else{a.removeClass("rowHover");a.removeClass("rowHover").prevAll("tr:has(td[rowspan]):first").find("td[rowspan]").removeClass("rowHover");$(this).closest("table").find("tr:not(.noHover) th:nth-child("+(t+1)+")").removeClass("headHover")}}}));$(".reduce-menu").on("click",(function(e){e.preventDefault();e.stopPropagation();switchFoldMenu()}));$(document).on("keydown","#page form textarea",(function(e){if(e.ctrlKey&&e.keyCode==13){submitparentForm($(this))}}));$(document).on("click",".see_debug",(function(){$("body > .debug-panel").toggle()}))}));var submitparentForm=function(e){var t=$(e).closest("form");var a=t.find("[type=submit]").filter("[name=add], [name=update]");if(a.length==1){return a.trigger("click")!==false}return false};var isImage=function(e){var t=["image/gif","image/jpeg","image/jpg","image/png"];if($.inArray(e.type,t)<0){return false}else{return true}};var getExtIcon=function(e){var t=CFG_GLPI.root_doc+"/pics/icones/"+e+"-dist.png";if(!urlExists(t)){t=CFG_GLPI.root_doc+"/pics/icones/defaut-dist.png"}return'<img src="'+t+'" title="'+e+'">'};var urlExists=function(e){var t=false;$.ajax({type:"HEAD",url:e,async:false,success:function(){t=true}});return t};var getSize=function(e){var t=["o","Kio","Mio","Gio","Tio"];var a="";t.some((function(t){if(e>1024){e=e/1024}else{a=t;return true}}));return Math.round(e*100,2)/100+a};var getBijectiveIndex=function(e){var t="";while(parseInt(e)>0){e--;t=String.fromCharCode("A".charCodeAt(0)+e%26)+t;e/=26}return t};var stopEvent=function(e){e.preventDefault();e.stopPropagation()};if($("#backtotop").length){var scrollTrigger=100,backToTop=function(){var e=$(window).scrollTop();if(e>scrollTrigger){$("#backtotop").addClass("d-md-block")}else{$("#backtotop").removeClass("d-md-block")}};backToTop();$(window).on("scroll",(function(){backToTop()}));$("#backtotop").on("click",(function(e){e.preventDefault();$("html,body").animate({scrollTop:0},700)}))}function _eltRealSize(e){var t=0;t+=e.outerHeight();t+=parseFloat(e.css("margin-top").replace("px",""));t+=parseFloat(e.css("margin-bottom").replace("px",""));t+=parseFloat(e.css("padding-top").replace("px",""));t+=parseFloat(e.css("padding-bottom").replace("px",""));return t}var initMap=function(e,t,a,n={position:[43.6112422,3.8767337],zoom:6}){t=typeof t!=="undefined"?t:"map";a=typeof a!=="undefined"?a:"200px";if(a=="full"){var r=$(window).height();var i=$(e).offset()["top"]+$(e).outerHeight();var o=Math.floor(r-i-2);var s=300;if(o<s){o=s}a=o+"px"}e.append($('<div id="'+t+'" style="height: '+a+'"></div>'));var l=L.map(t,{fullscreenControl:true}).setView(n.position,n.zoom);L.tileLayer("https://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:"&copy; <a href='https://osm.org/copyright'>OpenStreetMap</a> contributors"}).addTo(l);return l};var showMapForLocation=function(e){var t=$(e).data("fid");var a=$("#"+t).val();if(a==0){return}glpi_html_dialog({title:__("Display on map"),body:"<div id='location_map_dialog'/>",dialogclass:"modal-lg",show:function(){var e=initMap($("#location_map_dialog"),"location_map");e.spin(true);$.ajax({dataType:"json",method:"POST",url:CFG_GLPI.root_doc+"/ajax/getMapPoint.php",data:{itemtype:"Location",items_id:$("#"+t).val()}}).done((function(t){if(t.success===false){glpi_html_dialog({body:t.message})}else{var a=[];var n=L.marker([t.lat,t.lng]);a.push(n);var r=L.featureGroup(a).addTo(e);e.fitBounds(r.getBounds(),{padding:[50,50],maxZoom:10})}})).always((function(){e.spin(false)}))}})};var query={};function markMatch(e,t){var a=e.toUpperCase().indexOf(t.toUpperCase());var n=$("<span></span>");if(a<0){n.append(escapeMarkupText(e));return n.html()}n.html(escapeMarkupText(e.substring(0,a)));var r=$("<span class='select2-rendered__match'></span>");r.html(escapeMarkupText(e.substring(a,a+t.length)));n.append(r);n.append(escapeMarkupText(e.substring(a+t.length)));return n.html()}var templateResult=function(e){var t=$("<span></span>");t.attr("title",e.title);if(typeof query.term!=="undefined"&&typeof e.rendered_text!=="undefined"){t.html(e.rendered_text)}else{if(!e.text){return null}var a=e.text;if(!e.id){t.html(escapeMarkupText(a));return t}var n=query.term||"";var r=markMatch(a,n);if(e.level){var i="";var o=e.level;while(o>1){i=i+"&nbsp;&nbsp;&nbsp;";o=o-1}t.html(i+"&raquo;"+r)}else{t.html(r)}}return t};var typewatch=function(){var e=0;return function(t,a){clearTimeout(e);e=setTimeout(t,a)}}();var templateSelection=function(e){var t="";if(!("element"in e)){t=e.text}else if(Object.prototype.hasOwnProperty.call(e,"selection_text")){t=e.selection_text}else if(e.element.parentElement.nodeName=="OPTGROUP"){t=e.element.parentElement.getAttribute("label")+" - "+e.text}else{t=e.text}var a=$("<span></span>");a.html(escapeMarkupText(t));return a};var templateItilStatus=function(e){if(e===false){return null}var t=e.id||0;var a="";switch(parseInt(t)){case 1:a="new fas fa-circle";break;case 2:a="assigned far fa-circle";break;case 3:a="planned far fa-calendar";break;case 4:a="waiting fas fa-circle";break;case 5:a="solved far fa-circle";break;case 6:a="closed fas fa-circle";break;case 7:a="accepted fas fa-check-circle";break;case 8:a="observe fas fa-eye";break;case 9:a="eval far fa-circle";break;case 10:a="approval fas fa-question-circle";break;case 11:a="test fas fa-question-circle";break;case 12:a="qualif far fa-circle";break;case 13:a="refused far fa-times-circle";break;case 14:a="canceled fas fa-ban";break}return $(`<span><i class="itilstatus ${a}"></i> ${e.text}</span>`)};var templateValidation=function(e){if(e===false){return null}var t=e.id||0;var a="";switch(parseInt(t)){case 2:a="waiting far fa-clock";break;case 3:a="accepted fas fa-check";break;case 4:a="refused fas fa-times";break}return $(`<span><i class="validationstatus ${a}"></i> ${e.text}</span>`)};var templateItilPriority=function(e){if(e===false){return null}var t=e.id||0;var a=CFG_GLPI["priority_"+t]||"";var n="";if(a.length>0){n+=`<i class='fas fa-circle' style='color: ${a}'></i>`}return $(`<span>${n}&nbsp;${e.text}</span>`)};var getTextWithoutDiacriticalMarks=function(e){e=e.normalize("NFD");return e.replace(/[\u0300-\u036f]/g,"")};var escapeMarkupText=function(e){if(typeof e!=="string"){return e}if(e.indexOf(">")!==-1||e.indexOf("<")!==-1){e=jQuery.fn.select2.defaults.defaults.escapeMarkup(e)}return e};function updateProgress(e){var t=$("progress#progress"+e).first();$("div[data-progressid='"+e+"']").each((function(e,a){var n=$(a);var r=n.find(".progress-fg").first();var i=t.attr("value")/t.attr("max")*100;r.width(i+"%");if(n.data("append-percent")===1){var o=n.prop("title").replace(new RegExp("\\d*%$"),t.attr("value")+"%").trim();t.prop("title",o);n.prop("title",o)}}))}function hexToRgb(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function luminance(e){var t=e.map((function(e){e/=255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}));return t[0]*.2126+t[1]*.7152+t[2]*.0722}function contrast(e,t){return(luminance(e)+.05)/(luminance(t)+.05)}function GoInFullscreen(e){if(e.requestFullscreen){e.requestFullscreen()}else if(e.mozRequestFullScreen){e.mozRequestFullScreen()}else if(e.webkitRequestFullscreen){e.webkitRequestFullscreen()}else if(e.msRequestFullscreen){e.msRequestFullscreen()}}function GoOutFullscreen(){if(document.exitFullscreen){document.exitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}}function getUuidV4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=Math.random()*16|0,a=e=="x"?t:t&3|8;return a.toString(16)}))}window.glpiUnsavedFormChanges=false;$(document).ready((function(){$(document).on("input",'form[data-track-changes="true"] input:not([data-track-changes=""]),'+'form[data-track-changes="true"] textarea:not([data-track-changes="false"])',(function(){window.glpiUnsavedFormChanges=true}));$(document).on("change",'form[data-track-changes="true"] select:not([data-track-changes=""])',(function(){window.glpiUnsavedFormChanges=true}));$(window).on("beforeunload",(function(e){if(window.glpiUnsavedFormChanges){e.preventDefault();return""}}));$(document).on("submit","form",(function(){window.glpiUnsavedFormChanges=false}))}));function onTinyMCEChange(e){var t=$(e.target)[0];if($(t.targetElm).data("trackChanges")!==false){if($(t.formElement).data("trackChanges")===true){window.glpiUnsavedFormChanges=true}}}function relativeDate(e){var t=(+new Date-Date.parse(e))/1e3,a=t/60,n=a/60,r=n/24,i=r/365.242199,o;return(o=Math.round(t))===1?__("just now"):a<1.01?"%s seconds ago".replace("%s",o):(o=Math.round(a))===1?__("a minute ago"):n<1.01?"%s minutes ago".replace("%s",o):(o=Math.round(n))===1?__("an hour ago"):r<1.01?"%s hours ago".replace("%s",o):(o=Math.round(r))===1?__("yesterday"):i<1.01?"%s days ago".replace("%s",o):(o=Math.round(i))===1?__("a year ago"):"%s years ago".replace("%s",o)}function getFlatPickerLocale(e,t){if(e=="en"&&t=="GB"){return{firstDayOfWeek:1}}else{return e}}function updateItemOnEvent(e,t,a,n={},r=["change"],i=-1,o=-1,s=[]){if(!Array.isArray(e)){e=[e]}const l=e;$(l).each(((o,l)=>{$(r).each(((r,o)=>{const c=l.replace("[","_").replace("]","_");const u=$(`#${c}`);u.on(o,(()=>{const r=i>=0||s.length>0;const o=i>=0&&u.val().length()>=i;const l=s.length>0&&s.includes(u.val());const c=()=>{let r={};$.each(n,((t,a)=>{if(typeof a==="string"){const n=a.match(/^__VALUE(\d+)__$/);if(n!==null){r[t]=$("#"+e[n[0]]).val()}else if(a==="__VALUE__"){r[t]=$("#"+e[0]).val()}else{r[t]=a}}else{r[t]=a}}));$(t).load(a,r)};if(r&&(o||l)){c()}else if(!r){c()}}))}))}))}function updateItemOnSelectEvent(e,t,a,n={}){updateItemOnEvent(e,t,a,n,["change"],-1,-1,[])}function initTooltips(e){if(e===undefined){e=document}const t=e.querySelectorAll('[data-bs-toggle="tooltip"]:not([data-bs-original-title])');t.forEach((function(e){const t={delay:{show:50,hide:50},html:e.hasAttribute("data-bs-html")?e.getAttribute("data-bs-html")==="true":false,placement:e.hasAttribute("data-bs-placement")?e.getAttribute("data-bs-placement"):"auto",trigger:e.hasAttribute("data-bs-trigger")?e.getAttribute("data-bs-trigger"):"hover"};return new bootstrap.Tooltip(e,t)}));const a=e.querySelectorAll('[data-bs-toggle="popover"]:not([data-bs-original-title])');a.forEach((function(e){const t={delay:{show:50,hide:50},html:e.hasAttribute("data-bs-html")?e.getAttribute("data-bs-html")==="true":false,placement:e.hasAttribute("data-bs-placement")?e.getAttribute("data-bs-placement"):"auto",trigger:e.hasAttribute("data-bs-trigger")?e.getAttribute("data-bs-trigger"):"hover",sanitize:e.hasAttribute("data-bs-sanitize")?e.getAttribute("data-bs-sanitize")==="true":true};return new bootstrap.Popover(e,t)}))}$(document).ajaxSend((function(e,t,a){if(a.type!=="POST"){return}t.setRequestHeader("X-Glpi-Csrf-Token",getAjaxCsrfToken())}));function getAjaxCsrfToken(){const e=document.querySelector('meta[property="glpi:csrf_token"]');return e!==null?e.getAttribute("content"):null}$((function(){$(document).ajaxComplete((function(){initTooltips()}));setTimeout((function(){initTooltips()}),50)}));jQuery.expr.filters.icontains=function(e,t,a){return(e.innerText||e.textContent||"").toLowerCase().indexOf(a[3].toLowerCase())>-1};function tableToDetails(e){let t=false;const a=$(e).find(".section-header, .section-content");let n="";a.each(((e,a)=>{if(a.classList.contains("section-header")){if(t){n+="</details>"}n+=`<details><summary>${a.innerText}</summary><pre>`;t=true}else{if(t){n+=a.innerText}}}));if(t){n+="</pre></details>"}return n}function flashIconButton(e,t,a,n){const r=$(e);const i=r.find("i").eq(0);const o=r.attr("class");const s=i.attr("class");r.removeClass();i.removeClass();r.addClass(t);i.addClass(a);window.setTimeout((()=>{r.removeClass();i.removeClass();r.addClass(o);i.addClass(s)}),n)}function uniqid(e="",t=false){const a=Date.now()*1e3+Math.random()*1e3;const n=a.toString(16).replace(/\./g,"").padEnd(14,"0");const r=t?"."+Math.floor(Math.random()*1e8).toString().padStart(8,"0"):"";return`${e}${n}${r}`}function blockFormSubmit(e,t){var a=null;if(t.originalEvent&&t.originalEvent.submitter){a=$(t.originalEvent.submitter)}if(a===null||!a.is("button")){a=a.find('button[name="add"]:first, button[name="update"]:first');if(a.length===0){a=e.find('button[type="submit"]:first')}}if(a.length>0&&a.is("button")){a.html(`<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>`)}e.find('button[type="submit"]').click((e=>{e.preventDefault()}));e.attr("data-submitted","true")}$(document.body).on("submit","form[data-submit-once]",(e=>{const t=$(e.target).closest("form");if(t.attr("data-submitted")==="true"){e.preventDefault();return false}else{blockFormSubmit(t,e)}}));function strip_tags(e){var t=(new DOMParser).parseFromString(e,"text/html");return t.body.textContent}$(document.body).on("shown.bs.tab",'a[data-bs-toggle="tab"]',(e=>{const t=$(e.target);const a=t.parent().index()===0;const n=t.closest(".card-tabs").parent().find(".navigationheader");if(n.length>0){const e=n.find("span.is_recursive-toggle");if(e.length>0){const t=e.find("input");const n=t.prop("disabled");if(t.attr("data-disabled-initial")===undefined){t.attr("data-disabled-initial",n||false)}const r=t.attr("data-disabled-initial")==="true";t.prop("disabled",a?r:true)}}}));